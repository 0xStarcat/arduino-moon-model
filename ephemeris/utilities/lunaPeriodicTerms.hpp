
#if ARDUINO
#define CONST const PROGMEM
#else
#endif
#define CONST const

struct LunaPeriodicTerm
{
  int multipleD;
  int multipleM;
  int multipleM1;
  int multipleF;
  int coefficient;
};

struct LongDistCoefficients
{
  int multIndex;
  int coefficient;
};

struct LongDistMultipliers
{
  int multipleD;
  int multipleM;
  int multipleM1;
  int multipleF;
};

CONST LongDistMultipliers longDistMultipliers[] = {
    {0, 0, 1, 0},
    {2, 0, -1, 0},
    {2, 0, 0, 0},
    {0, 0, 2, 0},
    {0, 1, 0, 0},
    {0, 0, 0, 2},
    {2, 0, -2, 0},
    {2, -1, -1, 0},
    {2, 0, 1, 0},
    {2, -1, 0, 0},
    {0, 1, -1, 0},
    {1, 0, 0, 0},
    {0, 1, 1, 0},
    {2, 0, 0, -2},
    {0, 0, 1, 2},
    {0, 0, 1, -2},
    {4, 0, -1, 0},
    {0, 0, 3, 0},
    {4, 0, -2, 0},
    {2, 1, -1, 0},
    {2, 1, 0, 0},
    {1, 0, -1, 0},
    {1, 1, 0, 0},
    {2, -1, 1, 0},
    {2, 0, 2, 0},
    {4, 0, 0, 0},
    {2, 0, -3, 0},
    {0, 1, -2, 0},
    {2, 0, -1, 2},
    {2, -1, -2, 0},
    {1, 0, 1, 0},
    {2, -2, 0, 0},
    {0, 1, 2, 0},
    {0, 2, 0, 0},
    {2, -2, -1, 0},
    {2, 0, 1, -2},
    {2, 0, 0, 2},
    {4, -1, -1, 0},
    {0, 0, 2, 2},
    {3, 0, -1, 0},
    {2, 1, 1, 0},
    {4, -1, -2, 0},
    {0, 2, -1, 0},
    {2, 2, -1, 0},
    {2, 1, -2, 0},
    {2, -1, 0, -2},
    {4, 0, 1, 0},
    {0, 0, 4, 0},
    {4, -1, 0, 0},
    {1, 0, -2, 0},
    {2, 1, 0, -2},
    {0, 0, 2, -2},
    {1, 1, 1, 0},
    {3, 0, -2, 0},
    {4, 0, -3, 0},
    {2, -1, 2, 0},
    {0, 2, 1, 0},
    {1, 1, -1, 0},
    {2, 0, 3, 0},
    {2, 0, -1, -2}};

// Meeus (2015) pg 339 Table 47.A
CONST LongDistCoefficients moonLongitudeELP[] = {
    {0, 6288774},
    {1, 1274027},
    {2, 658314},
    {3, 213618},
    {4, -185116},
    {5, -114332},
    {6, 58793},
    {7, 57066},
    {8, 53322},
    {9, 45758},
    {10, -40923},
    {11, -34720},
    {12, -30383},
    {13, 15327},
    {14, -12528},
    {15, 10980},
    {16, 10675},
    {17, 10034},
    {18, 8548},
    {19, -7888},
    {20, -6766},
    {21, -5163},
    {22, 4987},
    {23, 4036},
    {24, 3994},
    {25, 3861},
    {26, 3665},
    {27, -2689},
    {28, -2602},
    {29, 2390},
    {30, -2348},
    {31, 2236},
    {32, -2120},
    {33, -2069},
    {34, 2048},
    {35, -1773},
    {36, -1595},
    {37, 1215},
    {38, -1110},
    {39, -892},
    {40, -810},
    {41, 759},
    {42, -713},
    {43, -700},
    {44, 691},
    {45, 596},
    {46, 549},
    {47, 537},
    {48, 520},
    {49, -487},
    {50, -399},
    {51, -381},
    {52, 351},
    {53, -340},
    {54, 330},
    {55, 327},
    {56, -323},
    {57, 299},
    {58, 294}};

// Meeus (2015) pg 339 Table 47.A
CONST LongDistCoefficients moonDistanceELP[] = {
    {0, -20905355},
    {1, -3699111},
    {2, -2955968},
    {3, -569925},
    {4, 48888},
    {5, -3149},
    {6, 246158},
    {7, -152138},
    {8, -170733},
    {9, -204586},
    {10, -129620},
    {11, 108743},
    {12, 104755},
    {13, 10321}, //
    {15, 79661},
    {16, -34782},
    {17, -23210},
    {18, -21636},
    {19, 24208},
    {20, 30824},
    {21, -8379},
    {22, -16675},
    {23, -12831},
    {24, -10445},
    {25, -11650},
    {26, 14403},
    {27, -7003}, //
    {29, 10056},
    {30, 6233},
    {31, -9884},
    {32, 5751},
    {34, -4950},
    {35, 4130},
    {37, -3958},
    {39, 3258},
    {40, 2616},
    {41, -1897},
    {42, -2117},
    {43, 2354},
    {46, -1423},
    {47, -1117},
    {48, -1571},
    {49, -1739},
    {51, -4421},
    {56, 1165},
    {59, 8752}};

// Meeus (2015) pg 339 Table 47.A
CONST LunaPeriodicTerm moonLatitudeELP[] = {
    {0, 0, 0, 1, 5128122},
    {0, 0, 1, 1, 280602},
    {0, 0, 1, -1, 277693},
    {2, 0, 0, -1, 173237},
    {2, 0, -1, 1, 55413},
    {2, 0, -1, -1, 46271},
    {2, 0, 0, 1, 32573},
    {0, 0, 2, 1, 17198},
    {2, 0, 1, -1, 9266},
    {0, 0, 2, -1, 8822},
    {2, -1, 0, -1, 8216},
    {2, 0, -2, -1, 4324},
    {2, 0, 1, 1, 4200},
    {2, 1, 0, -1, -3359},
    {2, -1, -1, 1, 2463},
    {2, -1, 0, 1, 2211},
    {2, -1, -1, -1, 2065},
    {0, 1, -1, -1, -1870},
    {4, 0, -1, -1, 1828},
    {0, 1, 0, 1, -1794},
    {0, 0, 0, 3, -1749},
    {0, 1, -1, 1, -1565},
    {1, 0, 0, 1, -1491},
    {0, 1, 1, 1, -1475},
    {0, 1, 1, -1, -1410},
    {0, 1, 0, -1, -1344},
    {1, 0, 0, -1, -1335},
    {0, 0, 3, 1, 1107},
    {4, 0, 0, -1, 1021},
    {4, 0, -1, 1, 833},
    {0, 0, 1, -3, 777},
    {4, 0, -2, 1, 671},
    {2, 0, 0, -3, 607},
    {2, 0, 2, -1, 596},
    {2, -1, 1, -1, 491},
    {2, 0, -2, 1, -451},
    {0, 0, 3, -1, 439},
    {2, 0, 2, 1, 422},
    {2, 0, -3, -1, 421},
    {2, 1, -1, 1, -366},
    {2, 1, 0, 1, -351},
    {4, 0, 0, 1, 311},
    {2, -1, 1, 1, 315},
    {2, -2, 0, -1, 302},
    {0, 0, 1, 3, -283},
    {2, 1, 1, -1, -229},
    {1, 1, 0, -1, 223},
    {1, 1, 0, 1, 223},
    {0, 1, -2, -1, -220},
    {2, 1, -1, -1, -220},
    {1, 0, 1, 1, -185},
    {2, -1, -2, -1, 181},
    {0, 1, 2, 1, -177},
    {4, 0, -2, -1, 176},
    {4, -1, -1, -1, 166},
    {1, 0, 1, -1, -164},
    {4, 0, 1, -1, 132},
    {1, 0, -1, -1, -119},
    {4, -1, 0, -1, 115},
    {2, -2, 0, 1, 107}};